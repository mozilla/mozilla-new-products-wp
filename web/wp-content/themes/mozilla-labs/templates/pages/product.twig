{% extends "layouts/base.twig" %}

{% set custom_nav_classes = post.meta("navigation_theme") %}
{% set email_signup_override = post.meta("email_signup") %}

{%- block custom_body_classes -%}
  {{ post.meta("page_theme")|default("theme-light") }}
{%- endblock -%}

{% block pageBody %}

<header class="grid grid-site grid-rows-[1fr_auto_1fr] h-[80vh] overflow-y-hidden isolate">
  {% set backdrop = post.meta("backdrop_image") %}

  {% if backdrop %}
    {% include "components/lazy-img.twig" with {
      class: "-mx-grid-site-margin col-start-1 col-end-13 row-span-full h-full w-screen",
      imgClass: "object-cover",
      img: get_image(backdrop)
    } %}
  {% endif %}

  <div class="
    col-start-1 col-span-full row-start-2 z-10 self-center justify-self-center size-fit
    px-8 pt-9 pb-8 lg:pt-14 lg:pb-12 lg:px-16
    bg-off-black/60 backdrop-blur-md
  ">
    <h1 class="text-white type-headline-2xl">{{ post.title }}</h1>
  </div>

  {% if post.categories|length %}
  <section class="col-start-1 col-span-full row-start-3 h-fit mt-auto py-grid-site-margin z-10">
    <h2 class="sr-only">Categories</h2>
    <ul class="flex justify-center gap-2 flex-wrap">
      {% for category in post.categories %}
        <li class="button-sm font-sans text-sm leading-none bg-off-black/60 text-white backdrop-blur-md whitespace-nowrap">
          {{ category.title }}
        </li>
      {% endfor %}
    </ul>
  </section>
  {% endif %}
</header>

<div class="grid grid-site gap-y-grid-site-gutter mt-grid-site-margin lg:mt-24">
  {% set icons = post.meta("icons") %}

  {% include 'components/product-overview.twig' with {
    icon: icons.primary ? get_image(icons.primary) : null,
    title: post.title,
    tagline: post.tagline,
  } %}

  {% set information = post.meta("information") %}
  {% set cta = post.meta("cta") %}

  {% if information|length or cta %}
    {% include 'components/product-information.twig' with {
      information: information,
      cta: cta,
    } %}
  {% endif %}

  {% include 'components/product-content.twig' with {
    content: post.meta("content")
  } %}
</div>

{% set articles = post.related_articles %}

{% if articles|length %}
<section class="grid grid-site mt-24">
  <h2 class="col-span-full sm:col-span-1/2 text-xs">{{ post.title }} News</h2>

  <div class="col-span-full sm:col-start-7 sm:col-span-1/2">
    <ol class="grid grid-cols-2 gap-x-grid-site-gutter gap-y-8">
      {% for article in articles %}
      <li>
        <time class="text-xs" datetime="{{ article.date|date('Y-m-d') }}">
          {{ article.date|date('m.d.y') }}
        </time>

        <h3 class="text-sm">
          <a class="hocus:underline" href="{{ article.link }}">
            {{ article.title }}
          </a>
        </h3>
      </li>
      {% endfor %}
    </ol>
  </div>
</section>
{% endif %}

{% endblock %}
